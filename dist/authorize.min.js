"use strict";!function(){angular.module("mr.authorize",["ui.router"]).provider("authorize",function(){var r=this;this._authed=function(r){return!!r.invoke(this.authed)},this._policies=function(r){return r.invoke(this.policies)},this.$get=["$injector","$state",function(e,i){function t(i){var t=r._policies(e);if(t)for(var n=0;n<t.length;n++)if(t[n].toUpperCase()===i.toUpperCase())return!0;return!1}function n(i){if(!i||!i.authed&&!i.policies)return!0;if(!r._authed(e))return 401;if(i.policies){for(var n=i.policies,u=!1,a=0;a<n.length;a++)t(n[a])&&(u=!0);if(!u)return 403}return!0}function u(r){var e=r.name.lastIndexOf(".");if(e<0)return null;var t=r.name.substring(0,e);return i.get(t)}function a(r){for(var e=[],i=r;;){e.push(i);var t=u(i);if(!t)break;i=t}return e}function o(r){var e=r.auth;if(!e)return null;if(e===!0)return{authed:!0};if(angular.isArray(e))return{policies:e};if(angular.isString(e))return{policies:[e]};if(angular.isObject(e))return e;throw new Error('auth property is invalid in the state: "'+r.name+'".')}function f(r){return angular.isFunction(r)||angular.isArray(r)}function s(){if(!f(r.authed)||!f(r.policies))throw new Error("Make sure you set authorizeProvider.authed and authorizeProvider.policies.")}return function(r){if(s(),angular.isString(r)&&(r=i.get(r)),!r)throw new Error("state undefined.");var e;e=r.name.lastIndexOf(".")<0?[r]:a(r);for(var t=0;t<e.length;t++){var u,f=o(e[t]);if((u=n(f))!==!0)return u;if(f&&f.override)break}return!0}}]})}();